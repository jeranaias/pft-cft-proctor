<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="NAVMC 11622 PFT/CFT Performance Worksheet Generator - Auto-calculate scores and generate official forms">
  <title>NAVMC 11622 Generator - PFT/CFT Proctor</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#8B0000">
  <link rel="apple-touch-icon" href="assets/icon-192.svg">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Styles -->
  <link rel="stylesheet" href="css/styles.css">
  <style>
    /* Additional styles for NAVMC worksheet UI */
    .worksheet-container {
      background: var(--surface);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-lg);
      overflow: hidden;
      margin-bottom: var(--space-6);
    }

    .worksheet-header {
      background: var(--bg-secondary);
      padding: var(--space-4);
      border-bottom: 1px solid var(--border-light);
    }

    .worksheet-header h2 {
      font-size: var(--text-lg);
      font-weight: var(--font-bold);
      margin-bottom: var(--space-2);
    }

    .worksheet-meta {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: var(--space-4);
    }

    .marine-entry {
      background: var(--surface);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-lg);
      margin-bottom: var(--space-4);
      overflow: hidden;
    }

    .marine-entry__header {
      background: var(--bg-secondary);
      padding: var(--space-3) var(--space-4);
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid var(--border-light);
    }

    .marine-entry__title {
      font-weight: var(--font-semibold);
    }

    .marine-entry__body {
      padding: var(--space-4);
    }

    .section-title {
      font-size: var(--text-sm);
      font-weight: var(--font-semibold);
      color: var(--primary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: var(--space-3);
      padding-bottom: var(--space-2);
      border-bottom: 2px solid var(--primary);
    }

    .score-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: var(--space-3);
    }

    .score-item {
      text-align: center;
      padding: var(--space-3);
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
    }

    .score-item__label {
      font-size: var(--text-xs);
      color: var(--text-secondary);
      margin-bottom: var(--space-1);
    }

    .score-item__value {
      font-size: var(--text-xl);
      font-weight: var(--font-bold);
      color: var(--primary);
    }

    .score-item__value--fail {
      color: var(--error);
    }

    .score-item__value--pass {
      color: var(--success);
    }

    .input-row {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: var(--space-2);
      align-items: end;
    }

    .input--small {
      width: 70px;
      text-align: center;
    }

    .time-input {
      display: flex;
      align-items: center;
      gap: var(--space-1);
    }

    .time-input input {
      width: 50px;
      text-align: center;
    }

    .time-input span {
      font-weight: var(--font-bold);
    }

    .calculated-score {
      background: var(--bg-tertiary);
      padding: var(--space-2) var(--space-3);
      border-radius: var(--radius-md);
      font-weight: var(--font-bold);
      min-width: 50px;
      text-align: center;
    }

    .marines-list {
      max-height: 400px;
      overflow-y: auto;
    }

    .marine-row {
      display: grid;
      grid-template-columns: 1fr 80px 80px auto;
      gap: var(--space-3);
      align-items: center;
      padding: var(--space-3);
      border-bottom: 1px solid var(--border-light);
    }

    .marine-row:last-child {
      border-bottom: none;
    }

    .marine-row__info {
      font-weight: var(--font-medium);
    }

    .marine-row__details {
      font-size: var(--text-xs);
      color: var(--text-secondary);
    }

    .total-display {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: var(--white);
      padding: var(--space-4);
      border-radius: var(--radius-lg);
      text-align: center;
      margin-top: var(--space-4);
    }

    .total-display__score {
      font-size: var(--text-4xl);
      font-weight: var(--font-bold);
    }

    .total-display__class {
      font-size: var(--text-lg);
      opacity: 0.9;
    }

    .quick-calc {
      background: var(--bg-secondary);
      padding: var(--space-4);
      border-radius: var(--radius-lg);
      margin-bottom: var(--space-4);
    }

    .event-group {
      background: var(--surface);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-md);
      padding: var(--space-4);
      margin-bottom: var(--space-4);
    }

    .event-group__title {
      font-weight: var(--font-semibold);
      margin-bottom: var(--space-3);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .event-group__score {
      background: var(--primary);
      color: var(--white);
      padding: var(--space-1) var(--space-3);
      border-radius: var(--radius-full);
      font-weight: var(--font-bold);
    }
  </style>
</head>
<body>
  <!-- Skip Link -->
  <a href="#main" class="skip-link">Skip to main content</a>

  <!-- Header -->
  <header class="header no-print">
    <div class="container">
      <h1 class="header__title">NAVMC 11622 Generator</h1>
      <p class="header__subtitle">PFT/CFT Performance Worksheet - Auto-Calculate & Generate</p>
      <div class="header__controls">
        <button id="theme-toggle" class="theme-toggle" onclick="App.toggleTheme()">Light</button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main id="main" class="container">

    <!-- Worksheet Header Info -->
    <div class="worksheet-container">
      <div class="worksheet-header">
        <h2>Session Information</h2>
        <div class="worksheet-meta">
          <div class="form-group m-0">
            <label class="label" for="session-unit">Unit</label>
            <input type="text" id="session-unit" class="input" placeholder="1/1 H&S Co">
          </div>
          <div class="form-group m-0">
            <label class="label" for="session-date">Date</label>
            <input type="date" id="session-date" class="input">
          </div>
          <div class="form-group m-0">
            <label class="label" for="session-monitor">Monitor Name</label>
            <input type="text" id="session-monitor" class="input" placeholder="SSgt Smith">
          </div>
        </div>
      </div>
    </div>

    <!-- Add Marine Form -->
    <div class="card mb-4">
      <div class="card__header">
        <h2 class="card__title">Add Marine</h2>
        <p class="card__subtitle">Enter Marine info and scores - points calculate automatically</p>
      </div>

      <form id="marine-form">
        <!-- Individual Data -->
        <div class="section-title">Individual Data</div>
        <div class="grid grid--2 mb-4">
          <div class="form-group">
            <label class="label" for="marine-rank">Rank</label>
            <select id="marine-rank" class="input select">
              <option value="Pvt">Pvt</option>
              <option value="PFC">PFC</option>
              <option value="LCpl" selected>LCpl</option>
              <option value="Cpl">Cpl</option>
              <option value="Sgt">Sgt</option>
              <option value="SSgt">SSgt</option>
              <option value="GySgt">GySgt</option>
              <option value="MSgt">MSgt</option>
              <option value="1stSgt">1stSgt</option>
              <option value="MGySgt">MGySgt</option>
              <option value="SgtMaj">SgtMaj</option>
              <option value="2ndLt">2ndLt</option>
              <option value="1stLt">1stLt</option>
              <option value="Capt">Capt</option>
              <option value="Maj">Maj</option>
              <option value="LtCol">LtCol</option>
              <option value="Col">Col</option>
            </select>
          </div>
          <div class="form-group">
            <label class="label" for="marine-lastname">Last Name</label>
            <input type="text" id="marine-lastname" class="input" placeholder="Smith">
          </div>
          <div class="form-group">
            <label class="label" for="marine-firstname">First Name</label>
            <input type="text" id="marine-firstname" class="input" placeholder="John">
          </div>
          <div class="form-group">
            <label class="label" for="marine-mi">MI</label>
            <input type="text" id="marine-mi" class="input" maxlength="1" placeholder="A">
          </div>
          <div class="form-group">
            <label class="label" for="marine-edipi">EDIPI</label>
            <input type="text" id="marine-edipi" class="input" placeholder="1234567890" maxlength="10">
          </div>
          <div class="form-group">
            <label class="label" for="marine-dob">Date of Birth</label>
            <input type="date" id="marine-dob" class="input">
          </div>
          <div class="form-group">
            <label class="label" for="marine-gender">Gender</label>
            <select id="marine-gender" class="input select">
              <option value="male">Male</option>
              <option value="female">Female</option>
            </select>
          </div>
          <div class="form-group">
            <label class="label" for="marine-age">Age (auto-calculated)</label>
            <input type="number" id="marine-age" class="input" readonly placeholder="--">
          </div>
          <div class="form-group">
            <label class="label" for="marine-height">Height (inches)</label>
            <input type="number" id="marine-height" class="input" placeholder="70" min="58" max="80">
          </div>
          <div class="form-group">
            <label class="label" for="marine-weight">Weight (lbs)</label>
            <input type="number" id="marine-weight" class="input" placeholder="180" min="80" max="350">
          </div>
        </div>

        <!-- PFT Section -->
        <div class="section-title">PFT Performance Data</div>

        <!-- Upper Body Event -->
        <div class="event-group">
          <div class="event-group__title">
            <span>Upper Body Event</span>
            <span id="upper-score" class="event-group__score">0 pts</span>
          </div>
          <div class="radio-group radio-group--horizontal mb-3">
            <label class="radio-label">
              <input type="radio" name="upper-event" value="pullups" class="radio" checked onchange="App.updateUpperEvent()">
              Pull-ups (max 100 pts)
            </label>
            <label class="radio-label">
              <input type="radio" name="upper-event" value="pushups" class="radio" onchange="App.updateUpperEvent()">
              Push-ups (max 70 pts)
            </label>
          </div>
          <div id="pullups-input" class="form-group">
            <label class="label" for="marine-pullups">Pull-ups (count)</label>
            <input type="number" id="marine-pullups" class="input" min="0" max="50" placeholder="0" oninput="App.calculateScores()">
          </div>
          <div id="pushups-input" class="form-group hidden">
            <label class="label" for="marine-pushups">Push-ups (count in 2 min)</label>
            <input type="number" id="marine-pushups" class="input" min="0" max="150" placeholder="0" oninput="App.calculateScores()">
          </div>
        </div>

        <!-- Plank -->
        <div class="event-group">
          <div class="event-group__title">
            <span>Plank</span>
            <span id="plank-score" class="event-group__score">0 pts</span>
          </div>
          <div class="form-group">
            <label class="label">Plank Time (MM:SS)</label>
            <div class="time-input">
              <input type="number" id="marine-plank-min" class="input" min="0" max="5" placeholder="0" oninput="App.calculateScores()">
              <span>:</span>
              <input type="number" id="marine-plank-sec" class="input" min="0" max="59" placeholder="00" oninput="App.calculateScores()">
            </div>
          </div>
        </div>

        <!-- Cardio Event -->
        <div class="event-group">
          <div class="event-group__title">
            <span>Cardio Event</span>
            <span id="cardio-score" class="event-group__score">0 pts</span>
          </div>
          <div class="radio-group radio-group--horizontal mb-3">
            <label class="radio-label">
              <input type="radio" name="cardio-event" value="run" class="radio" checked onchange="App.updateCardioEvent()">
              3-Mile Run
            </label>
            <label class="radio-label">
              <input type="radio" name="cardio-event" value="row" class="radio" onchange="App.updateCardioEvent()">
              5k Row (46+ or waiver)
            </label>
          </div>
          <div id="run-input" class="form-group">
            <label class="label">Run Time (MM:SS)</label>
            <div class="time-input">
              <input type="number" id="marine-run-min" class="input" min="0" max="45" placeholder="0" oninput="App.calculateScores()">
              <span>:</span>
              <input type="number" id="marine-run-sec" class="input" min="0" max="59" placeholder="00" oninput="App.calculateScores()">
            </div>
          </div>
          <div id="row-input" class="form-group hidden">
            <label class="label">Row Time (MM:SS)</label>
            <div class="time-input">
              <input type="number" id="marine-row-min" class="input" min="0" max="45" placeholder="0" oninput="App.calculateScores()">
              <span>:</span>
              <input type="number" id="marine-row-sec" class="input" min="0" max="59" placeholder="00" oninput="App.calculateScores()">
            </div>
          </div>
          <div class="form-group mt-2">
            <label class="checkbox-label">
              <input type="checkbox" id="marine-altitude" class="checkbox" onchange="App.calculateScores()">
              High Altitude (4,500ft+)
            </label>
          </div>
        </div>

        <!-- PFT Total -->
        <div class="total-display" id="pft-total-display">
          <div class="total-display__score" id="pft-total">0</div>
          <div class="total-display__class" id="pft-class">Enter scores above</div>
        </div>

        <!-- CFT Section -->
        <div class="section-title mt-6">CFT Performance Data</div>

        <div class="event-group">
          <div class="event-group__title">
            <span>Movement to Contact (880 yds)</span>
            <span id="mtc-score" class="event-group__score">0 pts</span>
          </div>
          <div class="form-group">
            <label class="label">MTC Time (MM:SS)</label>
            <div class="time-input">
              <input type="number" id="marine-mtc-min" class="input" min="0" max="10" placeholder="0" oninput="App.calculateCFTScores()">
              <span>:</span>
              <input type="number" id="marine-mtc-sec" class="input" min="0" max="59" placeholder="00" oninput="App.calculateCFTScores()">
            </div>
          </div>
        </div>

        <div class="event-group">
          <div class="event-group__title">
            <span>Ammunition Lift (30lb can, 2 min)</span>
            <span id="al-score" class="event-group__score">0 pts</span>
          </div>
          <div class="form-group">
            <label class="label" for="marine-al">Ammo Lift (count)</label>
            <input type="number" id="marine-al" class="input" min="0" max="200" placeholder="0" oninput="App.calculateCFTScores()">
          </div>
        </div>

        <div class="event-group">
          <div class="event-group__title">
            <span>Maneuver Under Fire (300 yds)</span>
            <span id="manuf-score" class="event-group__score">0 pts</span>
          </div>
          <div class="form-group">
            <label class="label">MANUF Time (MM:SS)</label>
            <div class="time-input">
              <input type="number" id="marine-manuf-min" class="input" min="0" max="10" placeholder="0" oninput="App.calculateCFTScores()">
              <span>:</span>
              <input type="number" id="marine-manuf-sec" class="input" min="0" max="59" placeholder="00" oninput="App.calculateCFTScores()">
            </div>
          </div>
          <div class="form-group mt-2">
            <label class="checkbox-label">
              <input type="checkbox" id="marine-cft-altitude" class="checkbox" onchange="App.calculateCFTScores()">
              High Altitude (4,500ft+)
            </label>
          </div>
        </div>

        <!-- CFT Total -->
        <div class="total-display" id="cft-total-display" style="background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-dark) 100%);">
          <div class="total-display__score" id="cft-total">0</div>
          <div class="total-display__class" id="cft-class">Enter scores above</div>
        </div>

        <!-- Add Marine Button -->
        <div class="flex gap-4 mt-6">
          <button type="button" class="btn btn--primary btn--lg" onclick="App.addMarineToWorksheet()">
            Add Marine to Worksheet
          </button>
          <button type="button" class="btn btn--outline" onclick="App.clearMarineForm()">
            Clear Form
          </button>
        </div>
      </form>
    </div>

    <!-- Marines in Worksheet -->
    <div class="card mb-4">
      <div class="card__header">
        <h2 class="card__title">NAVMC 11622 Worksheet</h2>
        <p class="card__subtitle">Marines added: <span id="marine-count">0</span></p>
      </div>

      <div id="marines-list" class="marines-list">
        <p class="text-secondary text-center p-4">No Marines added yet. Fill out the form above and click "Add Marine to Worksheet".</p>
      </div>

      <div class="flex gap-4 p-4 border-top">
        <button type="button" class="btn btn--primary btn--lg" onclick="App.generateNAVMC()" id="generate-btn" disabled>
          Generate NAVMC 11622 PDF
        </button>
        <button type="button" class="btn btn--outline" onclick="App.clearAllMarines()" id="clear-all-btn" disabled>
          Clear All
        </button>
      </div>
    </div>

    <!-- Quick Calculator (collapsible) -->
    <details class="card mb-4">
      <summary class="card__title" style="cursor: pointer; padding: var(--space-4);">
        Quick Score Calculator (Individual Use)
      </summary>
      <div class="p-4">
        <p class="text-secondary text-sm mb-4">Use this to quickly check scores without adding to the worksheet.</p>
        <div class="grid grid--2">
          <div class="form-group">
            <label class="label">Gender</label>
            <select id="quick-gender" class="input select" onchange="App.quickCalculate()">
              <option value="male">Male</option>
              <option value="female">Female</option>
            </select>
          </div>
          <div class="form-group">
            <label class="label">Age</label>
            <input type="number" id="quick-age" class="input" value="21" min="17" max="65" onchange="App.quickCalculate()">
          </div>
        </div>
        <div class="alert alert--info mt-4">
          Use the main form above for full functionality. This is just for quick score checks.
        </div>
      </div>
    </details>

  </main>

  <!-- Footer -->
  <footer class="footer no-print">
    <div class="container">
      <p class="text-sm text-secondary text-center">
        Generates official NAVMC 11622 format. <a href="https://github.com/jeranaias/pft-cft-proctor">View on GitHub</a>
      </p>
      <p class="text-sm text-secondary text-center mt-2">
        Based on MCO 6100.13A w/CH-4. Not an official DoD product.
      </p>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="js/scoring-tables.js"></script>
  <script src="js/calculator.js"></script>
  <script src="js/bodyfat.js"></script>
  <script src="js/storage.js"></script>
  <script src="js/navmc-generator.js"></script>
  <script src="js/app.js"></script>

  <!-- Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js');
    }
  </script>
</body>
</html>
